<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>üéÆ –£—á–∏–º –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ –±—É–∫–≤—ã - –°–£–ü–ï–† –∏–≥—Ä–∞!</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-user-select: none;
            user-select: none;
        }

        body {
            font-family: 'Comic Sans MS', 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }

        .game-container {
            background: white;
            border-radius: 30px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 700px;
            width: 100%;
            text-align: center;
            position: relative;
        }

        h1 {
            color: #667eea;
            font-size: 2.2em;
            margin-bottom: 5px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            animation: titleBounce 2s infinite;
        }

        @keyframes titleBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .subtitle {
            color: #666;
            font-size: 1.1em;
            margin-bottom: 20px;
        }

        .level-selector {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .level-btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 20px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .level-btn:hover {
            transform: scale(1.05);
        }

        .level-btn.active {
            background: linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%);
            box-shadow: 0 6px 20px rgba(76,175,80,0.4);
        }

        .score-board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
            font-size: 1.1em;
        }

        .score-item {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px;
            border-radius: 15px;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        .score-item span {
            font-size: 1.5em;
            display: block;
        }

        .stars-display {
            font-size: 2em;
            margin: 15px 0;
            min-height: 50px;
        }

        .star {
            display: inline-block;
            animation: starPop 0.5s ease-out;
        }

        @keyframes starPop {
            0% { transform: scale(0) rotate(0deg); }
            50% { transform: scale(1.3) rotate(180deg); }
            100% { transform: scale(1) rotate(360deg); }
        }

        .letter-display {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 25px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
            position: relative;
            overflow: hidden;
        }

        .letter-display:hover {
            transform: scale(1.02);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }

        .letter-display:active {
            transform: scale(0.98);
        }

        #letter-canvas {
            cursor: pointer;
        }

        .pronunciation {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            color: #d35400;
            font-size: 1.6em;
            font-weight: bold;
            padding: 15px;
            border-radius: 15px;
            margin: 15px 0;
            border: 3px solid #e67e22;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .pronunciation-label {
            font-size: 0.6em;
            color: #c0392b;
            margin-bottom: 5px;
        }

        .image-card {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-radius: 20px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            border: 3px solid #f093fb;
            animation: cardAppear 0.5s ease-out;
        }

        @keyframes cardAppear {
            0% {
                opacity: 0;
                transform: scale(0.8) translateY(20px);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .letter-art-container {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 20px 0;
            flex-wrap: wrap;
            gap: 20px;
        }

        .letter-art {
            font-size: 8em;
            font-weight: bold;
            position: relative;
            animation: letterBounce 2s ease-in-out infinite;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
        }

        @keyframes letterBounce {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-15px) rotate(5deg); }
        }

        .image-emoji {
            font-size: 5em;
            margin: 10px 0;
            animation: emojiFloat 3s ease-in-out infinite;
        }

        @keyframes emojiFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .image-word {
            font-size: 1.8em;
            font-weight: bold;
            color: #8e44ad;
            margin: 10px 0;
        }

        .image-translation {
            font-size: 1.3em;
            color: #34495e;
            font-style: italic;
        }

        /* –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –±—É–∫–≤-–∫–∞—Ä—Ç–∏–Ω–æ–∫ */
        .letter-art.apple { color: #e74c3c; }
        .letter-art.bear { color: #8B4513; }
        .letter-art.cat { color: #f39c12; }
        .letter-art.dog { color: #95a5a6; }
        .letter-art.elephant { color: #7f8c8d; }
        .letter-art.frog { color: #27ae60; }
        .letter-art.giraffe { color: #f39c12; }
        .letter-art.house { color: #e67e22; }
        .letter-art.ice { color: #3498db; }
        .letter-art.juice { color: #f1c40f; }
        .letter-art.key { color: #f39c12; }
        .letter-art.lion { color: #f39c12; }
        .letter-art.monkey { color: #8B4513; }
        .letter-art.night { color: #34495e; }
        .letter-art.octopus { color: #9b59b6; }
        .letter-art.penguin { color: #2c3e50; }
        .letter-art.queen { color: #e74c3c; }
        .letter-art.rocket { color: #e74c3c; }
        .letter-art.sun { color: #f39c12; }
        .letter-art.tiger { color: #e67e22; }
        .letter-art.umbrella { color: #3498db; }
        .letter-art.violin { color: #8B4513; }
        .letter-art.wolf { color: #7f8c8d; }
        .letter-art.box { color: #95a5a6; }
        .letter-art.yarn { color: #e91e63; }
        .letter-art.zebra { color: #2c3e50; }

        .options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin: 20px 0;
        }

        .option-btn {
            background: linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%);
            color: white;
            border: none;
            padding: 20px;
            font-size: 1.4em;
            font-weight: bold;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            text-transform: uppercase;
            position: relative;
        }

        .option-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }

        .option-btn:active {
            transform: translateY(0);
        }

        .option-btn.correct {
            animation: correctAnimation 0.6s;
        }

        .option-btn.wrong {
            animation: wrongAnimation 0.6s;
            background: linear-gradient(135deg, #f44336 0%, #e91e63 100%);
        }

        @keyframes correctAnimation {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.1) rotate(5deg); }
            50% { transform: scale(1.15) rotate(-5deg); }
            75% { transform: scale(1.1) rotate(3deg); }
        }

        @keyframes wrongAnimation {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-15px); }
            40% { transform: translateX(15px); }
            60% { transform: translateX(-10px); }
            80% { transform: translateX(10px); }
        }

        .controls {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .control-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 1.1em;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        .control-btn:hover {
            transform: scale(1.05);
        }

        .message {
            font-size: 1.6em;
            margin: 15px 0;
            min-height: 40px;
            font-weight: bold;
            animation: messageFade 0.5s;
        }

        @keyframes messageFade {
            0% { opacity: 0; transform: translateY(-10px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        .message.correct {
            color: #4CAF50;
        }

        .message.wrong {
            color: #f44336;
        }

        .progress-bar {
            background: #e0e0e0;
            height: 25px;
            border-radius: 15px;
            overflow: hidden;
            margin: 15px 0;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.1);
        }

        .progress-fill {
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
            height: 100%;
            transition: width 0.5s ease-out;
            border-radius: 15px;
            box-shadow: 0 0 10px rgba(76,175,80,0.5);
        }

        .combo-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            background: linear-gradient(135deg, #ff6b6b 0%, #feca57 100%);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.2em;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            animation: comboPulse 1s infinite;
        }

        @keyframes comboPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .floating-emoji {
            position: fixed;
            font-size: 3em;
            pointer-events: none;
            animation: floatUp 2s ease-out forwards;
            z-index: 1000;
        }

        @keyframes floatUp {
            0% {
                opacity: 1;
                transform: translateY(0) rotate(0deg);
            }
            100% {
                opacity: 0;
                transform: translateY(-200px) rotate(360deg);
            }
        }

        .timer {
            font-size: 1.5em;
            color: #e74c3c;
            font-weight: bold;
            margin: 10px 0;
        }

        @media (max-width: 600px) {
            h1 { font-size: 1.8em; }
            .score-board { grid-template-columns: 1fr; }
            .options-container { gap: 10px; }
            .option-btn { padding: 15px; font-size: 1.2em; }
        }
    </style>
</head>
<body aria-live="off">
    <div class="game-container">
        <h1>üéÆ –£—á–∏–º –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ –±—É–∫–≤—ã!</h1>
        <p class="subtitle">–í—ã–±–µ—Ä–∏ —É—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:</p>
        
        <div class="level-selector">
            <button class="level-btn active" onclick="setLevel('easy')" data-level="easy">
                üòä –õ—ë–≥–∫–∏–π
            </button>
            <button class="level-btn" onclick="setLevel('medium')" data-level="medium">
                ü§î –°—Ä–µ–¥–Ω–∏–π
            </button>
            <button class="level-btn" onclick="setLevel('hard')" data-level="hard">
                üî• –°–ª–æ–∂–Ω—ã–π
            </button>
        </div>

        <div class="score-board">
            <div class="score-item">
                ‚≠ê –û—á–∫–∏
                <span id="correct-count">0</span>
            </div>
            <div class="score-item">
                üíØ –ö–æ–º–±–æ
                <span id="combo-count">0</span>
            </div>
            <div class="score-item">
                ‚ùå –û—à–∏–±–∫–∏
                <span id="wrong-count">0</span>
            </div>
        </div>

        <div class="stars-display" id="stars-display"></div>

        <div class="progress-bar">
            <div class="progress-fill" id="progress"></div>
        </div>

        <div class="timer" id="timer" style="display: none;">‚è±Ô∏è <span id="time-left">10</span> —Å–µ–∫</div>

        <div class="letter-display" onclick="speakLetter()">
            <canvas id="letter-canvas" width="400" height="200" aria-hidden="true" role="img"></canvas>
        </div>

        <div class="pronunciation">
            <div class="pronunciation-label">–ü—Ä–æ–∏–∑–Ω–æ—Å–∏—Ç—Å—è:</div>
            <div id="pronunciation-text">[ ? ]</div>
        </div>

        <div class="image-card" id="image-card" style="display: none;">
            <div class="letter-art-container">
                <div class="letter-art" id="letter-art">A</div>
                <div class="image-emoji" id="image-emoji">üé®</div>
            </div>
            <div class="image-word" id="image-word">Word</div>
            <div class="image-translation" id="image-translation">–°–ª–æ–≤–æ</div>
        </div>

        <div class="message" id="message"></div>

        <div class="options-container" id="options-container">
            <!-- Options will be inserted here -->
        </div>

        <div class="controls">
            <button class="control-btn" onclick="speakLetter()">üîä –ü–æ–≤—Ç–æ—Ä–∏—Ç—å</button>
            <button class="control-btn" onclick="nextQuestion()">‚û°Ô∏è –°–ª–µ–¥—É—é—â–∞—è</button>
            <button class="control-btn" onclick="restartGame()">üîÑ –ó–∞–Ω–æ–≤–æ</button>
        </div>
    </div>

    <script>
        const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');
        let currentLetter = '';
        let correctAnswers = 0;
        let wrongAnswers = 0;
        let questionsAsked = 0;
        let totalQuestions = 10;
        let currentLevel = 'easy';
        let comboCount = 0;
        let timer = null;
        let timeLeft = 10;

        // –°–ª–æ–≤–∞—Ä—å –ø—Ä–æ–∏–∑–Ω–æ—à–µ–Ω–∏—è –±—É–∫–≤
        const letterPronunciation = {
            'A': '—ç–π', 'B': '–±–∏', 'C': '—Å–∏', 'D': '–¥–∏', 'E': '–∏',
            'F': '—ç—Ñ', 'G': '–¥–∂–∏', 'H': '—ç–π—á', 'I': '–∞–π', 'J': '–¥–∂–µ–π',
            'K': '–∫–µ–π', 'L': '—ç–ª', 'M': '—ç–º', 'N': '—ç–Ω', 'O': '–æ—É',
            'P': '–ø–∏', 'Q': '–∫—å—é', 'R': '–∞:', 'S': '—ç—Å', 'T': '—Ç–∏',
            'U': '—é', 'V': '–≤–∏', 'W': '–¥–∞–±–ª-—é', 'X': '—ç–∫—Å', 'Y': '—É–∞–π', 'Z': '–∑–µ–¥'
        };

        // –ö–∞—Ä—Ç–∏–Ω–∫–∏-–∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –±—É–∫–≤—ã
        const letterImages = {
            'A': { emoji: 'üçé', word: 'Apple', translation: '–Ø–±–ª–æ–∫–æ', class: 'apple' },
            'B': { emoji: 'üêª', word: 'Bear', translation: '–ú–µ–¥–≤–µ–¥—å', class: 'bear' },
            'C': { emoji: 'üê±', word: 'Cat', translation: '–ö–æ—à–∫–∞', class: 'cat' },
            'D': { emoji: 'üê∂', word: 'Dog', translation: '–°–æ–±–∞–∫–∞', class: 'dog' },
            'E': { emoji: 'üêò', word: 'Elephant', translation: '–°–ª–æ–Ω', class: 'elephant' },
            'F': { emoji: 'üê∏', word: 'Frog', translation: '–õ—è–≥—É—à–∫–∞', class: 'frog' },
            'G': { emoji: 'ü¶í', word: 'Giraffe', translation: '–ñ–∏—Ä–∞—Ñ', class: 'giraffe' },
            'H': { emoji: 'üè†', word: 'House', translation: '–î–æ–º', class: 'house' },
            'I': { emoji: 'üç¶', word: 'Ice cream', translation: '–ú–æ—Ä–æ–∂–µ–Ω–æ–µ', class: 'ice' },
            'J': { emoji: 'üßÉ', word: 'Juice', translation: '–°–æ–∫', class: 'juice' },
            'K': { emoji: 'üîë', word: 'Key', translation: '–ö–ª—é—á', class: 'key' },
            'L': { emoji: 'ü¶Å', word: 'Lion', translation: '–õ–µ–≤', class: 'lion' },
            'M': { emoji: 'üêµ', word: 'Monkey', translation: '–û–±–µ–∑—å—è–Ω–∞', class: 'monkey' },
            'N': { emoji: 'üåô', word: 'Night', translation: '–ù–æ—á—å', class: 'night' },
            'O': { emoji: 'üêô', word: 'Octopus', translation: '–û—Å—å–º–∏–Ω–æ–≥', class: 'octopus' },
            'P': { emoji: 'üêß', word: 'Penguin', translation: '–ü–∏–Ω–≥–≤–∏–Ω', class: 'penguin' },
            'Q': { emoji: 'üë∏', word: 'Queen', translation: '–ö–æ—Ä–æ–ª–µ–≤–∞', class: 'queen' },
            'R': { emoji: 'üöÄ', word: 'Rocket', translation: '–†–∞–∫–µ—Ç–∞', class: 'rocket' },
            'S': { emoji: '‚òÄÔ∏è', word: 'Sun', translation: '–°–æ–ª–Ω—Ü–µ', class: 'sun' },
            'T': { emoji: 'üêØ', word: 'Tiger', translation: '–¢–∏–≥—Ä', class: 'tiger' },
            'U': { emoji: '‚òÇÔ∏è', word: 'Umbrella', translation: '–ó–æ–Ω—Ç', class: 'umbrella' },
            'V': { emoji: 'üéª', word: 'Violin', translation: '–°–∫—Ä–∏–ø–∫–∞', class: 'violin' },
            'W': { emoji: 'üê∫', word: 'Wolf', translation: '–í–æ–ª–∫', class: 'wolf' },
            'X': { emoji: 'üì¶', word: 'Box', translation: '–ö–æ—Ä–æ–±–∫–∞', class: 'box' },
            'Y': { emoji: 'üß∂', word: 'Yarn', translation: '–ù–∏—Ç–∫–∏', class: 'yarn' },
            'Z': { emoji: 'ü¶ì', word: 'Zebra', translation: '–ó–µ–±—Ä–∞', class: 'zebra' }
        };

        // –†–∏—Å—É–µ–º –±—É–∫–≤—É –Ω–∞ canvas
        function drawLetter(letter) {
            const canvas = document.getElementById('letter-canvas');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = 'white';
            ctx.font = 'bold 160px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText(letter, canvas.width / 2, canvas.height / 2);
        }

        function setLevel(level) {
            currentLevel = level;
            document.querySelectorAll('.level-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.level === level) {
                    btn.classList.add('active');
                }
            });
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —É—Ä–æ–≤–Ω–µ–π
            if (level === 'easy') {
                totalQuestions = 10;
                document.getElementById('timer').style.display = 'none';
            } else if (level === 'medium') {
                totalQuestions = 15;
                document.getElementById('timer').style.display = 'block';
                timeLeft = 15;
            } else {
                totalQuestions = 20;
                document.getElementById('timer').style.display = 'block';
                timeLeft = 10;
            }
            
            restartGame();
        }

        function startTimer() {
            if (currentLevel === 'easy') return;
            
            clearInterval(timer);
            timeLeft = currentLevel === 'medium' ? 15 : 10;
            document.getElementById('time-left').textContent = timeLeft;
            
            timer = setInterval(() => {
                timeLeft--;
                document.getElementById('time-left').textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    wrongAnswers++;
                    comboCount = 0;
                    showMessage(false);
                    setTimeout(() => nextQuestion(), 1500);
                }
            }, 1000);
        }

        function getRandomLetter() {
            return alphabet[Math.floor(Math.random() * alphabet.length)];
        }

        function getWrongOptions(correctLetter, count) {
            const options = [];
            while (options.length < count) {
                const letter = getRandomLetter();
                if (letter !== correctLetter && !options.includes(letter)) {
                    options.push(letter);
                }
            }
            return options;
        }

        function shuffle(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function speakLetter() {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                setTimeout(() => {
                    const utterance = new SpeechSynthesisUtterance(currentLetter);
                    utterance.lang = 'en-US';
                    utterance.rate = 0.8;
                    utterance.pitch = 1.2;
                    utterance.volume = 1;
                    window.speechSynthesis.speak(utterance);
                }, 100);
            }
        }

        function updatePronunciation() {
            const pronunciationEl = document.getElementById('pronunciation-text');
            if (currentLetter && letterPronunciation[currentLetter]) {
                pronunciationEl.textContent = `[ ${letterPronunciation[currentLetter]} ]`;
            } else {
                pronunciationEl.textContent = '[ ? ]';
            }
        }

        function showImageCard(letter) {
            const imageCard = document.getElementById('image-card');
            const imageData = letterImages[letter];
            
            if (imageData) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±—É–∫–≤—É —Å —Ü–≤–µ—Ç–æ–º
                const letterArt = document.getElementById('letter-art');
                letterArt.textContent = letter;
                letterArt.className = 'letter-art ' + imageData.class;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º emoji –∏ —Ç–µ–∫—Å—Ç
                document.getElementById('image-emoji').textContent = imageData.emoji;
                document.getElementById('image-word').textContent = imageData.word;
                document.getElementById('image-translation').textContent = imageData.translation;
                imageCard.style.display = 'block';
            }
        }

        function hideImageCard() {
            const imageCard = document.getElementById('image-card');
            imageCard.style.display = 'none';
        }

        function updateScore() {
            document.getElementById('correct-count').textContent = correctAnswers;
            document.getElementById('wrong-count').textContent = wrongAnswers;
            document.getElementById('combo-count').textContent = comboCount;
            
            const progress = (questionsAsked / totalQuestions) * 100;
            document.getElementById('progress').style.width = progress + '%';
        }

        function showStars(count) {
            const starsDisplay = document.getElementById('stars-display');
            starsDisplay.innerHTML = '';
            for (let i = 0; i < count; i++) {
                setTimeout(() => {
                    const star = document.createElement('span');
                    star.className = 'star';
                    star.textContent = '‚≠ê';
                    starsDisplay.appendChild(star);
                }, i * 100);
            }
        }

        function createFloatingEmoji(emoji) {
            const floatingEmoji = document.createElement('div');
            floatingEmoji.className = 'floating-emoji';
            floatingEmoji.textContent = emoji;
            floatingEmoji.style.left = Math.random() * window.innerWidth + 'px';
            floatingEmoji.style.top = window.innerHeight / 2 + 'px';
            document.body.appendChild(floatingEmoji);
            
            setTimeout(() => {
                floatingEmoji.remove();
            }, 2000);
        }

        function showMessage(isCorrect) {
            const messageEl = document.getElementById('message');
            if (isCorrect) {
                const messages = ['–ú–æ–ª–æ–¥–µ—Ü! üéâ', '–û—Ç–ª–∏—á–Ω–æ! üåü', '–ü—Ä–∞–≤–∏–ª—å–Ω–æ! üëç', '–°—É–ø–µ—Ä! üéä', '–£–º–Ω–∏—Ü–∞! üí™', '–ë–ª–µ—Å—Ç—è—â–µ! ‚ú®'];
                messageEl.textContent = messages[Math.floor(Math.random() * messages.length)];
                messageEl.className = 'message correct';
                
                // –ó–≤—ë–∑–¥–æ—á–∫–∏ –∑–∞ –∫–æ–º–±–æ
                if (comboCount >= 3) {
                    showStars(Math.min(comboCount, 5));
                    createFloatingEmoji('üî•');
                }
            } else {
                const messages = ['–ü–æ–ø—Ä–æ–±—É–π –µ—â—ë! üòä', '–ü–æ—á—Ç–∏! üí™', '–ù–µ –ø–µ—Ä–µ–∂–∏–≤–∞–π! üåà', '–ü–æ–ª—É—á–∏—Ç—Å—è! üéØ'];
                messageEl.textContent = messages[Math.floor(Math.random() * messages.length)];
                messageEl.className = 'message wrong';
            }

            setTimeout(() => {
                messageEl.textContent = '';
                messageEl.className = 'message';
            }, 2000);
        }

        function checkAnswer(selectedLetter, btnElement) {
            clearInterval(timer);
            const allButtons = document.querySelectorAll('.option-btn');
            allButtons.forEach(btn => btn.disabled = true);

            if (selectedLetter === currentLetter) {
                correctAnswers++;
                comboCount++;
                btnElement.classList.add('correct');
                showMessage(true);
                createFloatingEmoji(['üéâ', '‚ú®', 'üåü', 'üí´'][Math.floor(Math.random() * 4)]);
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞—Ä—Ç–∏–Ω–∫—É-–∞—Å—Å–æ—Ü–∏–∞—Ü–∏—é
                setTimeout(() => {
                    showImageCard(currentLetter);
                }, 500);
                
                setTimeout(() => {
                    hideImageCard();
                    nextQuestion();
                }, 3000);
            } else {
                wrongAnswers++;
                comboCount = 0;
                btnElement.classList.add('wrong');
                showMessage(false);
                
                allButtons.forEach(btn => {
                    if (btn.textContent.includes(currentLetter)) {
                        btn.style.background = 'linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%)';
                        btn.style.transform = 'scale(1.1)';
                    }
                });

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–∞—Ä—Ç–∏–Ω–∫—É –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ
                setTimeout(() => {
                    showImageCard(currentLetter);
                }, 800);

                setTimeout(() => {
                    allButtons.forEach(btn => {
                        btn.disabled = false;
                        btn.classList.remove('wrong');
                        btn.style.background = 'linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%)';
                        btn.style.transform = 'scale(1)';
                    });
                    hideImageCard();
                }, 3000);
            }

            updateScore();
        }

        function nextQuestion() {
            if (questionsAsked >= totalQuestions) {
                showFinalScore();
                return;
            }

            clearInterval(timer);
            hideImageCard();
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
            }

            questionsAsked++;
            currentLetter = getRandomLetter();
            
            drawLetter('?');
            document.getElementById('pronunciation-text').textContent = '[ ? ]';
            
            const numOptions = currentLevel === 'easy' ? 4 : currentLevel === 'medium' ? 6 : 8;
            const wrongOptions = getWrongOptions(currentLetter, numOptions - 1);
            const allOptions = shuffle([currentLetter, ...wrongOptions]);
            
            const optionsContainer = document.getElementById('options-container');
            optionsContainer.innerHTML = '';
            optionsContainer.style.gridTemplateColumns = currentLevel === 'hard' ? 'repeat(4, 1fr)' : '1fr 1fr';
            
            allOptions.forEach(letter => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerHTML = `${letter} <span style="font-size: 0.6em; opacity: 0.8;">(${letter.toLowerCase()})</span>`;
                btn.setAttribute('aria-label', `–ë—É–∫–≤–∞ ${letter}`);
                btn.onclick = function() { checkAnswer(letter, btn); };
                optionsContainer.appendChild(btn);
            });

            setTimeout(() => {
                speakLetter();
                updatePronunciation();
                startTimer();
            }, 300);

            updateScore();
        }

        function showFinalScore() {
            clearInterval(timer);
            const container = document.querySelector('.game-container');
            const percentage = Math.round((correctAnswers / totalQuestions) * 100);
            let emoji = 'üéâ';
            let message = '–û—Ç–ª–∏—á–Ω–æ!';
            let stars = '‚≠ê';
            
            if (percentage === 100) {
                emoji = 'üèÜ';
                message = '–ò–î–ï–ê–õ–¨–ù–û!';
                stars = '‚≠ê‚≠ê‚≠ê';
            } else if (percentage >= 80) {
                emoji = 'üåü';
                message = '–°–£–ü–ï–†!';
                stars = '‚≠ê‚≠ê';
            } else if (percentage >= 60) {
                emoji = 'üëç';
                message = '–•–æ—Ä–æ—à–æ!';
                stars = '‚≠ê';
            } else {
                emoji = 'üí™';
                message = '–ü—Ä–æ–¥–æ–ª–∂–∞–π!';
                stars = '‚≠ê';
            }

            container.innerHTML = `
                <h1 style="font-size: 3em;">${emoji}</h1>
                <h2 style="color: #667eea; margin: 20px 0;">${message}</h2>
                <div style="font-size: 4em; margin: 20px 0;">${stars}</div>
                <div style="font-size: 5em; margin: 30px 0; color: #4CAF50; font-weight: bold;">${percentage}%</div>
                <div style="font-size: 1.5em; margin: 20px 0;">
                    <div style="margin: 15px 0; padding: 15px; background: linear-gradient(135deg, #4CAF50, #8BC34A); color: white; border-radius: 15px;">
                        ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: <strong>${correctAnswers}</strong>
                    </div>
                    <div style="margin: 15px 0; padding: 15px; background: linear-gradient(135deg, #667eea, #764ba2); color: white; border-radius: 15px;">
                        üíØ –õ—É—á—à–µ–µ –∫–æ–º–±–æ: <strong>${Math.max(...Array(questionsAsked).keys()).filter((_, i) => i < comboCount).length}</strong>
                    </div>
                    <div style="margin: 15px 0; padding: 15px; background: linear-gradient(135deg, #f44336, #e91e63); color: white; border-radius: 15px;">
                        ‚ùå –û—à–∏–±–æ–∫: <strong>${wrongAnswers}</strong>
                    </div>
                </div>
                <button class="control-btn" onclick="location.reload()" style="margin-top: 30px; font-size: 1.5em; padding: 20px 40px;">
                    üîÑ –ò–≥—Ä–∞—Ç—å –µ—â—ë —Ä–∞–∑
                </button>
            `;
        }

        function restartGame() {
            correctAnswers = 0;
            wrongAnswers = 0;
            questionsAsked = 0;
            comboCount = 0;
            clearInterval(timer);
            nextQuestion();
        }

        // –°—Ç–∞—Ä—Ç –∏–≥—Ä—ã
        window.onload = function() {
            nextQuestion();
        };
    </script>
</body>
</html>
